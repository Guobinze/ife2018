<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>index4</title>
</head>
<body>
	<div id="fade-obj" style="width:300px;height:300px;background:#000;opacity:1"></div>
	<button id="fade-btn">淡出</button>

	<script type="text/javascript">
		let fadeObj = document.querySelector('#fade-obj');
		let btn = document.querySelector('#fade-btn');
		let steps = 50;
        let currentStep = 1;

		function fadeOut() {
			let timer = setInterval(() => {
				if(currentStep > steps) {
					clearInterval(timer);
					currentStep = 1;
					btn.innerHTML = '淡入';
					btn.removeAttribute('disabled');
				}
				else {
					fadeObj.style.opacity = 1 - 1 / steps * currentStep++;
					btn.setAttribute('disabled', true);
				}
			},50)
		}

		function fadeIn() {
			let timer = setInterval(() => {
				if(currentStep > steps) {
					clearInterval(timer);
					currentStep = 1;
					btn.innerHTML = '淡出';
					btn.removeAttribute('disabled');
				}
				else {
					fadeObj.style.opacity = 1 / steps * currentStep++;
					btn.setAttribute('disabled', true);
				}
			},50)
		}

        btn.onclick = () => (fadeObj.style.opacity == 1)? fadeOut(): fadeIn();		


        /******以下利用setTimeout实现***********************************************

        let fadeObj = document.querySelector('#fade-obj');
        let btn = document.querySelector('#fade-btn');

        function fadeOut() {
            if(fadeObj.style.opacity <= 0) {
            	clearTimeout(fadeOut);
            	btn.innerHTML = '淡入';
            	btn.removeAttribute('disabled');
            	fadeObj.style.opacity = 0;
            }else {
            	fadeObj.style.opacity -= 0.05;
            	btn.setAttribute('disabled', true);
        		setTimeout(fadeOut,50);
            }       
        	
        }
        function fadeIn() {
        	if(fadeObj.style.opacity >= 1) {
            	clearTimeout(fadeIn);
            	btn.innerHTML = '淡出';
            	btn.removeAttribute('disabled');
            	fadeObj.style.opacity = 1;
            }else {
            	fadeObj.style.opacity += 0.05;
            	btn.setAttribute('disabled', true);
        		setTimeout(fadeIn,50);
            }    
        }


        btn.onclick = () => (fadeObj.style.opacity == 1)? fadeOut(): fadeIn();
        ****************************************************************************/

	</script>
</body>
</html>